import {observer} from "mobx-react-lite";
import {useMemo, useRef, useState} from "react";
import {useSafeAreaInsets} from "react-native-safe-area-context";
import {defaultPaddingX, defaultPaddingY, px, screenHeight} from "../lib/features";
import {Header} from "../ui/components/Header/Header";
import {ModalWrapper} from "../ui/components/ModalWrapper/ModalWrapper";
import {SpacingY} from "../ui/components/Spacing/SpacingY";
import {Caption} from "../ui/components/Typography/Caption";
import {Title} from "../ui/components/Typography/Title";
import {RoundedButton} from "../ui/components/Buttons/RoundedButton";
import Cross from "../assets/icons/Cross.svg";
import {Subhead} from "../ui/components/Typography/Subhead";
import {StyleSheet, View} from "react-native";
import {Button} from "../ui/components/Buttons/Button";

const TermsOfUseModal = observer(({modalRef, onClose, onConfirm, showButton}) => {
    // Todo: нужно получать с сервера /api/mb/terms-of-use
    const termsOfUse = "Пользовательское соглашение<br/>1. Термины и определения.<br/>1.1. Сайт facebank.store (Сайт «Фейсбанк») – сайт в сети Интернет, включая все уровни указанного домена, включая его мобильную версию и мобильные клиенты (приложения), владельцем и администратором которых является Сервис-провайдер.<br/>1.2. Сервис – комплекс услуг, оказываемых Сервис-провайдером, по публикации, облачному хранению, поиску, обработке и реализации Контента посредством использования программного обеспечения Сервис-провайдера с использованием Сайта.<br/>1.3. Контент – включает, но не ограничивается изображениями, видеозаписями, аудиозаписями и прочими результатами интеллектуальной и творческой деятельности, полученными в результате съемки, произведенной в местах, открытых для свободного посещения или на публичных мероприятиях, к которым можно получить доступ посредством использования Сервиса.<br/>1.4. Продавец – лицо, являющееся партнером Сервис-провайдера на основании агентского соглашения, которое публикует на Сайте и реализует с помощью Сервиса Контент Покупателям, предоставляя простую неисключительную лицензию на право использования приобретенного Контента в объеме и в пределах, предусмотренных настоящими Условиями.<br/><br/>Продавец может являться автором, его наследником, любым физическим или юридическим лицом, которое обладает правами на реализацию Контента, полученными в силу закона или договора.<br/><br/>Информация о Продавцах доступна в соответствующем разделе Сайта.<br/>1.5. Покупатель – право- и дееспособное физическое лицо, являющееся пользователем Сайта, приобретающее Контент с использованием Сервиса.<br/>1.7. Сервис-провайдер – юридическое лицо ООО «АБОЛЪ», созданное и осуществляющее свою деятельность в соответствии с законодательством Российской Федерации, зарегистрированное по адресу: Российская Федерация, 199106, г. Санкт-Петербург, пр-кт Средний В.О., д.88, литера А, пом. 39Н, оф. 703, являющееся правообладателем исключительных прав на Сайт и программных продуктов, обеспечивающих функционал Сервиса.<br/>1.8. Оператор платежей – уполномоченный Сервис-провайдером оператор денежных средств, обеспечивающий возможность осуществления операций по безналичному расчету между Покупателем и Продавцом.<br/>1.9. В настоящих Условиях могут быть использованы иные термины и определения, не указанные в п.1 Условий. В этом случае толкование такого термина производится в соответствии с текстом Условий. В случае отсутствия однозначного толкования термина или определения в тексте Условий следует руководствоваться его толкованием, определенным: в первую очередь – указанными в нем обязательными документами, во вторую очередь – законодательством Российской Федерации, и в последующем – обычаями делового оборота.<br/>2. Общие положения.<br/>2.1. Настоящие условия регламентируют порядок пользования Сервисом.<br/>2.2. Настоящие Условия являются открытыми и общедоступными.<br/><br/>Сервис-провайдер оставляет за собой право в любое время изменять, добавлять, удалять и/или редактировать пункты настоящих Условий посредством публикации Условий в новой редакции на Сайте. Изменения настоящих Условий вступают в силу с момента их публикации на Сайте, при этом, на отношения, возникшие до опубликования актуальной редакции Условий, распространяется редакция, действовавшая на момент возникновения отношений между Пользователями в результате использования Сервиса.<br/>2.3. Воспользовавшись Сервисом, Пользователь подтверждает, что он:<br/>- ознакомился с настоящими Условиями до начала использования Сервиса;<br/>- принимает настоящие Условия в полном объеме без каких-либо изъятий и ограничений и обязуется их соблюдать или прекратить использование Сервиса.<br/>2.4. Результатом использования Сервиса при совершении встречных конклюдентных действий со стороны Покупателя и Продавца в силу положений ст.ст. 437 и 438 Гражданского кодекса Российской Федерации является возникновение договорных отношений между Продавцом и Покупателем и утверждение прав и обязанностей сторон (в том числе, учитывающих требования Закона РФ от 07.02.1992 N 2300-1 (ред. от 14.07.2022) «О защите прав потребителей»).<br/><br/>При этом Покупатель уведомлен и согласен с тем, что Сервис-провайдер не оказывает Покупателю платных услуг, а только предоставляет возможность приобрести Контент Продавца. В связи с этим, отношения между Сервис-провайдером и Покупателем по предоставлению Сервиса на безвозмездной основе не регулируются Законом РФ от 07.02.1992 N 2300-1 (ред. от 14.07.2022) «О защите прав потребителей».<br/>2.5. Для обеспечения возможности Покупателя реализовать права на защиту своих интересов, возникших в результате сложившихся договорных отношений с Продавцом, предусмотренных действующим гражданским законодательством, Сервис-провайдер предоставляет Покупателю информацию о партнерах Сервиса и их контактах путем опубликования ее на Сайте, а также в случае обращения Покупателя к Сервис-провайдеру Покупателю.<br/>2.6. При возникновении проблем в использовании Сервиса, получении Пользователем недостоверной информации от третьих лиц, либо информации оскорбительного характера, либо любой иной неприемлемой информации, Пользователь имеет право обратиться к Сервис-провайдеру для проверки и устранения выявленных дефектов и причин замечаний, принятия мер по ограничению публикации на Сайте нежелательных информации и Контента, которые могут нарушить или нарушают права и охраняемые законом интересы Пользователей, а также, при необходимости, ограничить либо прекратить обязательства по предоставлению своих услуг любому Пользователю, умышленно нарушающему настоящие Условия.<br/>2.7. Сервис-провайдер оставляет за собой право удалять Контент, опубликованный на Сайте, и предпринимать технические и юридические меры для прекращения доступа к Сервису Пользователей, создающих, согласно заключению Сервис-провайдера, проблемы в использовании Сайта другими Пользователями.<br/>2.8. Сервис-провайдер оставляет за собой право не предоставлять Сервис Пользователям, нарушающим настоящие Условия.<br/>2.9. Использование Сервиса означает принятие настоящих Условий. Если Пользователь не согласен с требованиями настоящих Условий или ограничен, в силу закона, в действиях, которые могут повлечь возникновение договорных отношений в результате пользования Сервисом, Пользователю следует незамедлительно прекратить любое использование Сервиса.<br/>3. Персональная информация Покупателя.<br/>3.1. Принимая настоящие Условия, Покупатель дает согласие на обработку и использование необходимой для Сервиса информации о себе в соответствии с положениями Федерального закона №152 от 27.07.2006 «О защите персональных данных» (с действующими на момент пользования Сервисом дополнениями).<br/>3.2. Сервис-провайдер не осуществляет обработку как основных персональных данных Покупателей, включая имя, фамилию, отчество, почтовый адрес и иные данные, не связанные с предоставлением Сервиса, так и вторичных (технических) данных – файлы cookies, информация о соединениях и системная информация.<br/>Осуществляет обработку только той информации, которая необходима ему для достижения конкретных, заранее определенных и законных целей и не является оператором персональных данных.<br/>3.4. Сервис не является информационной системой персональных данных в том понимании, в котором это предусмотрено Федеральным законом №152 от 27.07.2006 «О защите персональных данных», которая отвечает всем признакам и характеристикам информационной системы, предназначенной для обработки персональные данные.<br/>4. Функционал Сервиса:<br/>4.1. Для Продавца, Сервис предоставляет возможность:<br/>- публикации Контента;<br/>- реализации Контента.<br/>4.2. Для Покупателя, Сервис предоставляет возможность:<br/>- ознакомления с Контентом;<br/>- подбора Контента, содержащего изображение субъектов, визуально схожих с Покупателем;<br/>- выбора и приобретения Контента.<br/>4.3. Использование Сервиса Покупателем возможно без прохождения Покупателем предварительной регистрации и/или авторизации на Сайте. Фактическим пользованием, Покупатель выражает свою волю и согласие на обработку Сервисом того объема информации, который необходим для достижения конкретных, заранее определенных и понятных Покупателю целей, предусмотренных в п.4.2. настоящих Условий.<br/>4.4. Использование Сервиса Продавцом осуществляется только после заключения договора с Сервис-провайдером и прохождения предварительной регистрации и авторизации на Сайте.<br/>5. Пользователям запрещены:<br/>5.1. Призывы к насильственному изменению или свержению конституционного строя или к захвату государственной власти; призывы к погромам, поджогам, уничтожению имущества, захвату зданий или сооружений, насильственному выселению граждан; призывы к агрессии или к развязыванию военного конфликта.<br/>5.2. Прямые и косвенные оскорбления кого-либо, в частности политиков, чиновников, журналистов, Пользователей Сервиса, в том числе по национальной, этнической, расовой или религиозной принадлежности, а также шовинистические высказывания.<br/>5.3. Нецензурные высказывания, высказывания порнографического, эротического или сексуального характера.<br/>5.4. Любое оскорбительное поведение по отношению к авторам Контента и всем Пользователям Сервиса.<br/>5.5. Высказывания, целью которых есть намеренное провоцирование резкой реакции других Пользователей Сервиса.<br/>5.6. Реклама, коммерческие сообщения, а также сообщения, которые не имеют информационной нагрузки и не касаются тематики Сайта, если на такую рекламу или сообщение не получено специального разрешения от администрации сайта.<br/>5.7. Любые сообщения и прочие действия, которые запрещены законодательством РФ.<br/>5.8. Выдача себя за другого человека или представителя организации и/или сообщества без достаточных на то прав, в том числе за сотрудников и владельцев Сайта, а также введение в заблуждение относительно свойств и характеристик каких-либо субъектов или объектов.<br/>5.9. Размещение Контента, который Пользователь не имеет права публиковать по закону или согласно каким-либо контрактным отношениям, а также Контента, который нарушает права на какой-либо патент, торговую марку, коммерческую тайну, копирайт или прочие права собственности и/или авторские и смежные с ним права третьей стороны.<br/>5.10. Доступ к Сервису Сайта лиц, возраст которых не достиг 18 лет, за исключением лиц, не достигших указанного в настоящем пункте возраста, если такой доступ осуществлен в присутствии и с согласия родителей или законных представителей.<br/>5.11. Нарочное или случайное нарушения каких-либо применимых местных, государственных или международных нормативно – правовых актов.<br/>6. Лицензия на использование Контента.<br/>6.1. Фактом опубликования Контента, Продавец выражает свою волю и согласие на передачу Сервис-провайдеру и Покупателю неисключительной, бесплатной и всемирной лицензии на воспроизведение, использование и сохранение приобретенного Контента, без разрешения или ссылки на фотографа или Сайт и права на использование Контента в коммерческих целях и рекламе.<br/>6.2. Лицензия не включает право компилировать Контент, приобретенный на Сайте, для репликации аналогичного или конкурирующего сайта.<br/>6.3. Сервис-провайдер запрещает Продавцам публиковать материалы, защищенные авторским правом, без разрешения владельца авторских прав.<br/>7. Условия оплаты Контента.<br/>7.1. Покупатель имеет возможность выбрать и купить Контент, содержащий изображение субъекта, визуально схожего с Покупателем, посредством осуществления безналичной оплаты.<br/>7.2. Покупатель может осуществить покупку посредством предоставления платежных данных, необходимых для осуществления платежа, запрашиваемых Оператором платежей, обеспечивающим организацию безналичных расчетов. Указанные данные предоставляются непосредственно Оператору платежей с использованием принадлежащих ему программных средств и не доступны для Сервис-провайдера. Вместе с тем, Оператор платежей передает Сервис-провайдеру реквизиты платежа, не содержащие персональных данных Покупателя, для фиксации операции в Сервисе.<br/>7.3. Сервис не предусматривает возможности отмены покупки после осуществления ее оплаты и предоставления Покупателю права скачать приобретенный Контент.<br/><br/>Ввиду вышеуказанного, в целях предоставления Покупателю исчерпывающей информации о приобретаемом Контенте до осуществления покупки Покупатель получает доступ к цифровой версии Контента, содержащей водяные знаки, и имеет возможность ознакомиться с Контентом.<br/>7.4. В силу Условий, предусмотренных п.2.4., все спорные вопросы относительно договорных отношений, сложившихся между Продавцом и Покупателем, в силу положений ст.ст. 437 и 438 Гражданского кодекса Российской Федерации, Пользователи решают посредством прямого взаимодействия без привлечения Сервис-провайдера.<br/>8. Ограничение ответственности Сервис-провайдера.<br/>8.1. Сервис-провайдер не несет никакой ответственности за любые ошибки, опечатки и неточности, которые могут быть обнаружены в материалах, опубликованных на Сайте Продавцом. Сервис-провайдер прикладывает все необходимые усилия, чтобы обеспечить точность и достоверность публикуемой на Сайте информации.<br/>8.2. Информация на Сайте постоянно обновляется и в любой момент может стать устаревшей. Сервис-провайдер не несет ответственности за неспособность Пользователя получить обновления общедоступной информации, опубликованной на Сайте.<br/>8.3. Сервис-провайдер не несет ответственности перед третьими лицами, в случае публикации Продавцом Контента, нарушающего права и охраняемые законом интересы таких лиц. Всю ответственность за содержание такого Контента и, соответствие его требованиям применимого права, несет Продавец, опубликовавший его на Сайте.<br/><br/>В то же время Сервис-провайдер принимает все возможные меры, чтобы не допускать публикацию Контента, нарушающего действующее законодательство или нормы морали.<br/>8.4. Сервис-провайдер не несет ответственности за ущерб, убытки или расходы (реальные либо возможные), возникшие в связи использованием или невозможностью использования Сервиса.<br/>"
    const insets = useSafeAreaInsets();

    const snapPoints = [screenHeight - insets.top];

    return (
      <ModalWrapper
        modalRef={modalRef}
        contentStyle={{
          paddingHorizontal: defaultPaddingX
        }}
        // onContentSizeChange={handleContentSizeChange}
        snapPoints={snapPoints}
        initialSnapIndex={0}
        enablePanDownToClose
        enableContentPanning
        withScroll
      >
        <SpacingY size={defaultPaddingY} />
        <Header
          title={<Title level={2}>Соглашение</Title>}
          after={<RoundedButton onPress={onClose}><Cross /></RoundedButton>}
        />
        <SpacingY size={15} />

        {termsOfUse.split("<br/>").map((str, index) =>
          <Caption
            key={index}
            style={{opacity: 0.8}}
            weight={2}
          >
            {str}
          </Caption>
        )}

        {showButton ? (
          <>
            <SpacingY size={15} />
            <Button
              size={'l'}
              background={'green'}
              style={[styles.button]}
              onPress={onConfirm}>
              <Subhead weight={2} color={'light'}>
                Согласен
              </Subhead>
            </Button>
          </>
        ) : <></>}
        <SpacingY size={insets.bottom + defaultPaddingY} />
      </ModalWrapper>
    );
});


const styles = StyleSheet.create({

});

export {TermsOfUseModal};